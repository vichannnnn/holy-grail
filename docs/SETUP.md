# Setup Guide

This guide provides detailed instructions for setting up the Holy Grail project locally.

## Prerequisites

- **Node.js 18+** and **Bun** (recommended) or npm/yarn
- **Python 3.11+**
- **Docker** (for PostgreSQL database)
- **UV** (Python package manager - will be installed if not present)

## Initial Setup

### 1. Clone the Repository

```bash
git clone <repository-url>
cd holy-grail
```

### 2. Install Dependencies

From the root directory:

```bash
bun install
```

This will install dependencies for all packages in the monorepo.

### 3. Environment Configuration

The project uses environment files for configuration. Example files with sensible defaults are provided:

#### Backend Environment (.env)

The backend `.env` file is created automatically when you first run the backend. Default values from `.env.example` include:

```bash
# Core Settings
ENVIRONMENT=local
SECRET_KEY=<auto-generated if not provided>

# Database (PostgreSQL in Docker)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=holy_grail
POSTGRES_USER=holy_grail
POSTGRES_PASSWORD=holy_grail

# Optional for local development
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
EMAIL_ENABLED=false
```

#### Frontend Environment

Frontend environment files are managed per environment:
- `.env` - Local development
- `.env.development` - Development server
- `.env.production` - Production server

### 4. Database Setup

Start the PostgreSQL database:

```bash
bun run db
```

This will:
- Start a PostgreSQL container on port 5432
- Create the database with the configured credentials
- Run any pending migrations automatically

### 5. Start Development Servers

Start all services (backend and frontend):

```bash
bun run dev
```

This will start:
- **Backend API** on http://localhost:8000
- **Frontend** on http://localhost:3000
- **New Frontend** on http://localhost:3001

## Verifying Your Setup

1. **Check the Backend API**
   - Navigate to http://localhost:8000/docs
   - You should see the FastAPI Swagger documentation

2. **Check the Frontend**
   - Navigate to http://localhost:3000
   - You should see the Holy Grail homepage

3. **Test API Connection**
   - In the frontend, try accessing the library page
   - It should load without errors

## Package-Specific Setup

### Backend Only

If you only want to work on the backend:

```bash
cd apps/backend
bun run setup    # Creates .env and installs Python dependencies
bun run dev      # Starts backend on port 8000
```

### Frontend Only

If you only want to work on the frontend:

```bash
cd apps/frontend
bun install
bun run dev      # Starts frontend on port 3000
```

## Database Management

### Running Migrations

```bash
cd apps/backend
bun run migrate
```

### Creating New Migrations

```bash
cd apps/backend
bun run migrate:create "description of changes"
```

### Seeding Sample Data

```bash
cd apps/backend
bun run seed
```

## Next Steps

- See [DEVELOPMENT.md](./DEVELOPMENT.md) for development workflow
- See [ARCHITECTURE.md](./ARCHITECTURE.md) for system design
- See [TROUBLESHOOTING.md](./TROUBLESHOOTING.md) for common issues